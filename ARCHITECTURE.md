# 아키텍처 문서

## 프로젝트 구조

```
liminal-space/
├── src/
│   ├── main.ts                 # 진입점
│   ├── game/
│   │   └── Game.ts            # 게임 메인 루프
│   ├── renderer/
│   │   ├── Renderer.ts        # 렌더러 메인
│   │   ├── GPURenderer.ts     # WebGPU 기본 파이프라인
│   │   ├── materials/
│   │   │   └── PBRMaterial.ts # PBR 머티리얼 시스템
│   │   ├── lighting/
│   │   │   └── LightingSystem.ts # 조명 시스템 (GI 포함)
│   │   └── postprocess/
│   │       └── PostProcessPipeline.ts # 포스트 프로세싱 (TAA 등)
│   ├── world/
│   │   └── World.ts           # 백화점 월드 구조
│   ├── player/
│   │   └── Player.ts          # 플레이어 컨트롤러
│   ├── monster/
│   │   └── Monster.ts         # 괴물 AI
│   └── input/
│       └── InputManager.ts    # 입력 관리
├── wasm/
│   ├── Cargo.toml            # Rust WASM 설정
│   └── src/
│       └── lib.rs            # WASM 물리 엔진
└── [설정 파일들]
```

## 기술 스택

### 렌더링
- **WebGPU**: 커스텀 렌더러 기반
- **내부 해상도**: 2560×1440 (1440p)
- **안티앨리어싱**: TAA (Temporal Anti-Aliasing)
- **렌더링 파이프라인**: 
  - PBR (물리 기반 렌더링)
  - Global Illumination
  - 소프트 섀도우
  - 포스트 프로세싱

### 성능
- **WASM**: Rust 기반 물리/수학 계산
- **타겟 프레임레이트**: 60fps (최소 30fps)
- **최적화 전략**: 품질 스케일링 (오브젝트 삭제 금지)

### 배포
- **빌드 도구**: Vite
- **배포 플랫폼**: Vercel
- **HTTPS 필수**: WebGPU 요구사항

## 핵심 설계 원칙

### 1. 편법 금지
- ❌ 오브젝트 삭제/팝인/팝아웃
- ❌ 어둠으로 디테일 숨김
- ❌ 로우폴리 + DOF/블룸으로 뭉개기
- ❌ 반복 텍스처가 한눈에 보임
- ❌ 빈 상점

### 2. 현실감 우선
- 모든 구조물은 물리적으로 존재
- 플레이어는 실체를 가진 존재
- 모든 상호작용은 4요소 포함 (시각/충돌/소리/AI)

### 3. 성능 vs 품질
- 품질 유지가 우선
- 성능 문제 시 오브젝트 삭제가 아닌 품질 스케일링
- 반사 품질, 그림자 거리, GI 업데이트 레이트 조절

## 구현 상태

### ✅ 완료
- [x] 프로젝트 기본 구조
- [x] WebGPU 렌더러 프레임워크
- [x] 게임 루프 구조
- [x] 입력 시스템
- [x] 플레이어 컨트롤러 기본
- [x] 괴물 AI 기본 구조
- [x] 월드 구조 설계
- [x] Vercel 배포 설정

### 🚧 진행 중
- [ ] PBR 머티리얼 실제 구현
- [ ] GI (Global Illumination) 구현
- [ ] TAA 구현
- [ ] 물리 엔진 (WASM)
- [ ] 백화점 지오메트리 생성
- [ ] 괴물 AI 로직 완성

### 📋 계획
- [ ] 상호작용 시스템 (문, 오브젝트)
- [ ] 소리 시스템
- [ ] 각 층별 디테일 구현
- [ ] 최적화 및 성능 튜닝

## 다음 단계

1. **PBR 머티리얼 셰이더 구현**
   - WebGPU 셰이더 코드 작성
   - 유리, 대리석, 금속, 플라스틱, 패브릭 각각 구현

2. **조명 시스템 완성**
   - 실내 조명 구조물 배치
   - GI 프로브 시스템
   - 간접광 계산

3. **월드 지오메트리 생성**
   - 백화점 기본 구조
   - 각 층별 특성 반영
   - 반복 방지 메커니즘

4. **물리 엔진 통합**
   - WASM 물리 시뮬레이션
   - 충돌 시스템
   - 캐릭터 컨트롤러 개선
